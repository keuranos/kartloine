<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1200, initial-scale=0.5, minimum-scale=0.1, maximum-scale=5.0, user-scalable=yes">
    <title>OSINT Event Database - Visual Analytics</title>
    
    <!-- Open Graph Meta Tags for Link Previews -->
    <meta property="og:title" content="OSINT Event Database - Visual Analytics" id="og-title">
    <meta property="og:description" content="Explore and analyze OSINT events with interactive map visualization and detailed analytics." id="og-description">
    <meta property="og:type" content="website">
    <meta property="og:url" content="" id="og-url">
    <meta property="og:site_name" content="OSINT Event Database">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="OSINT Event Database - Visual Analytics" id="twitter-title">
    <meta name="twitter:description" content="Explore and analyze OSINT events with interactive map visualization and detailed analytics." id="twitter-description">

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8BZSPEG2QR"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-8BZSPEG2QR');
    </script>

    <!-- External Libraries -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <div class="header">
        <h1>üîç OSINT Event Database - Visual Analytics</h1>
        <div class="stats" id="stats"></div>
        
        <!-- Time Range Controls - Redesigned with Manual Inputs -->
        <div class="time-slider-container" id="timeSliderContainer" style="display: none;">
            <div class="time-controls-row">
                <div class="time-control-buttons">
                    <button class="time-control-btn" id="playBtn">PLAY</button>
                    <button class="time-control-btn" id="pauseBtn" style="display: none;">PAUSE</button>
                    <button class="time-control-btn" id="resetBtn">Reset</button>
                </div>
                <div class="time-manual-inputs">
                    <div class="time-input-group">
                        <label>From:</label>
                        <input type="text" id="manualStartDate" placeholder="DD/MM/YYYY" maxlength="10" class="time-date-input">
                    </div>
                    <div class="time-input-group">
                        <label>To:</label>
                        <input type="text" id="manualEndDate" placeholder="DD/MM/YYYY" maxlength="10" class="time-date-input">
                    </div>
                    <button class="time-control-btn apply-btn" id="applyManualRangeBtn">Apply</button>
                </div>
            </div>
            <div class="time-slider-row">
                <label>Timeline:</label>
                <input type="range" id="timeSlider" min="0" max="100" value="100" step="1" class="time-slider">
                <div class="time-slider-display">
                    <span id="timeSliderStartDate">2025-10-12</span>
                    <span>‚Üí</span>
                    <span id="timeSliderEndDate">2025-10-22</span>
                </div>
            </div>
        </div>
        
        <div id="fileUploadUI" style="display: none;">
            <h3 style="color: #667eea; margin-bottom: 10px;">üìÅ Upload CSV File</h3>
            <input type="file" id="csvFileInput" accept=".csv">
            <p style="margin-top: 10px; color: #666; font-size: 14px;">
                <strong>üìù Instructions:</strong> Place your <code>tapahtumat.csv</code> file in the same directory as this HTML file, or upload it here.
            </p>
        </div>
    </div>

    <!-- Control Buttons Container -->
    <div class="bottom-controls">
        <button class="ctrl-btn" id="searchToggleBtn">
            <span style="font-size: 18px;">üîç</span> Search
        </button>
        <button class="ctrl-btn feed-active" id="feedToggleBtn">
            <span style="font-size: 18px;">üì±</span> Feed
        </button>
        <button class="ctrl-btn" id="timelineToggleBtn">
            <span style="font-size: 18px;">‚è±Ô∏è</span> Timeline
        </button>
        <button class="ctrl-btn" id="analyticsBtn" onclick="AnalyticsManager.openAnalyticsModal()">
            <span style="font-size: 18px;">üìä</span> Analytics
        </button>
        <button class="ctrl-btn" id="exportBtn" onclick="ExportManager.openExportModal()">
            <span style="font-size: 18px;">üì•</span> Export
        </button>
        <button class="ctrl-btn" id="aboutBtn" onclick="UIManager.openAboutModal()">
            <span style="font-size: 18px;">‚ÑπÔ∏è</span> About
        </button>
        <button class="ctrl-btn" id="resetAllBtn" onclick="App.resetAllFilters()">
            <span style="font-size: 18px;">üîÑ</span> Reset All
        </button>
        <button class="ctrl-btn" id="legendToggleBtn">
            <span style="font-size: 18px;">üó∫Ô∏è</span>
        </button>
        <button class="ctrl-btn" id="darkModeToggleBtn" onclick="UIManager.toggleDarkMode()">
            <span style="font-size: 18px;">üåô</span>
        </button>
    </div>

    <!-- Map Legend Panel -->
    <div class="legend-panel" id="legendPanel">
        <div class="legend-header">
            <h3>üó∫Ô∏è Map Legend</h3>
            <button class="legend-close" id="legendCloseBtn">√ó</button>
        </div>
        <div class="legend-content">
            <div class="legend-section">
                <h4>Circle Markers (Generic Events)</h4>
                <div class="legend-item">
                    <div class="legend-marker" style="background: #3388ff; border: 2px solid #fff;"></div>
                    <span>Ukrainian side events</span>
                </div>
                <div class="legend-item">
                    <div class="legend-marker" style="background: #ff4444; border: 2px solid #fff;"></div>
                    <span>Russian side events</span>
                </div>
                <div class="legend-item">
                    <div class="legend-marker" style="background: #888; border: 2px solid #fff;"></div>
                    <span>Unknown/Neutral side</span>
                </div>
                <div class="legend-note">Note: Faded markers = already viewed</div>
            </div>
            <div class="legend-section">
                <h4>Entity Markers (Systems & Units)</h4>
                <div class="legend-item">
                    <div class="legend-icon">üöÅ</div>
                    <span>Weapon systems (drones, missiles, etc.)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-icon">ü™ñ</div>
                    <span>Military units and brigades</span>
                </div>
                <div class="legend-note">Color: Blue (UA) / Red (RU) / Gray (Unknown)</div>
            </div>
            <div class="legend-section">
                <h4>Flag Markers</h4>
                <div class="legend-item">
                    <div class="legend-flag" style="background: linear-gradient(180deg, #0057b7 50%, #ffd700 50%);"></div>
                    <span>Ukrainian flag markers</span>
                </div>
                <div class="legend-item">
                    <div class="legend-flag" style="background: linear-gradient(180deg, #fff 33%, #0039a6 33%, #0039a6 66%, #d52b1e 66%);"></div>
                    <span>Russian flag markers</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Search Panel -->
    <div class="bottom-filter-panel" id="bottomSearchPanel">
        <div class="filter-panel-content">
            <div class="search-tabs">
                <button class="search-tab active" id="locationSearchTab">üìç Search Location</button>
                <button class="search-tab" id="eventSearchTab">üìã Search Events</button>
            </div>

            <!-- Location Search -->
            <div class="search-section" id="locationSearchSection">
                <div class="filter-row">
                    <div class="filter-group">
                        <label>Search Place (e.g., "Kiev", "Kyiv, Ukraine", "Mariupol")</label>
                        <input type="text" id="locationSearchInput" placeholder="Enter city or place name...">
                    </div>
                </div>
                <div class="filter-actions">
                    <button class="btn btn-primary" id="searchLocationBtn">üîç Search Location</button>
                </div>
                <div id="locationSearchResults" class="search-results"></div>
            </div>

            <!-- Event Search -->
            <div class="search-section" id="eventSearchSection" style="display: none;">
                <div class="filter-row">
                    <div class="filter-group">
                        <label>
                            Search Events
                            <button class="search-help-btn" onclick="SearchEnhancer.showSearchHelp()" title="Show search syntax help">
                                ‚ùì
                            </button>
                        </label>
                        <input type="text" id="searchInput" placeholder="Try: kinzhal AND kharkiv, drone OR missile, etc...">
                    </div>
                    <div class="filter-group" style="max-width: 200px;">
                        <label>Start Date</label>
                        <input type="date" id="startDate">
                    </div>
                    <div class="filter-group" style="max-width: 200px;">
                        <label>End Date</label>
                        <input type="date" id="endDate">
                    </div>
                </div>

                <!-- Date Range Presets -->
                <div class="date-presets">
                    <span class="date-presets-label">Quick Ranges:</span>
                    <button class="date-preset-btn" onclick="SearchEnhancer.applyDatePreset('today')">Today</button>
                    <button class="date-preset-btn" onclick="SearchEnhancer.applyDatePreset('yesterday')">Yesterday</button>
                    <button class="date-preset-btn" onclick="SearchEnhancer.applyDatePreset('last7days')">Last 7 Days</button>
                    <button class="date-preset-btn" onclick="SearchEnhancer.applyDatePreset('last30days')">Last 30 Days</button>
                    <button class="date-preset-btn" onclick="SearchEnhancer.applyDatePreset('thisMonth')">This Month</button>
                    <button class="date-preset-btn" onclick="SearchEnhancer.applyDatePreset('lastMonth')">Last Month</button>
                    <button class="date-preset-btn" onclick="SearchEnhancer.applyDatePreset('thisYear')">This Year</button>
                    <button class="date-preset-btn" onclick="SearchEnhancer.applyDatePreset('all')">All Time</button>
                </div>

                <div class="filter-actions">
                    <button class="btn btn-primary" id="applyFiltersBtn">Apply Filters</button>
                    <button class="btn btn-secondary" id="resetFiltersBtn">Reset All Filters</button>
                </div>
            </div>
        </div>
    </div>

    <!-- All Modals -->
    <div id="eventsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üìã All Events</h2>
                <button class="modal-close" onclick="closeModal('eventsModal')">&times;</button>
            </div>
            <div class="modal-search">
                <input type="text" id="eventsModalSearch" placeholder="üîç Search events...">
            </div>
            <div class="modal-selection-count" id="eventsSelectionCount">0 events selected</div>
            <div class="modal-list" id="eventsModalList"></div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-clear" onclick="clearModalSelection('events')">Clear All</button>
                <button class="modal-btn modal-btn-apply" onclick="applyModalFilter('events')">Apply Filter</button>
            </div>
        </div>
    </div>

    <div id="locationsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üìç All Locations</h2>
                <button class="modal-close" onclick="closeModal('locationsModal')">&times;</button>
            </div>
            <div class="modal-search">
                <input type="text" id="locationsModalSearch" placeholder="üîç Search locations...">
            </div>
            <div class="modal-selection-count" id="locationsSelectionCount">0 locations selected</div>
            <div class="modal-list" id="locationsModalList"></div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-clear" onclick="clearModalSelection('locations')">Clear All</button>
                <button class="modal-btn modal-btn-apply" onclick="applyModalFilter('locations')">Apply Filter</button>
            </div>
        </div>
    </div>

    <div id="entitiesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üë• All Entities</h2>
                <button class="modal-close" onclick="closeModal('entitiesModal')">&times;</button>
            </div>
            <div class="modal-search">
                <input type="text" id="entitiesModalSearch" placeholder="üîç Search entities...">
            </div>
            <div class="modal-selection-count" id="entitiesSelectionCount">0 entities selected</div>
            <div class="modal-list" id="entitiesModalList"></div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-clear" onclick="clearModalSelection('entities')">Clear All</button>
                <button class="modal-btn modal-btn-apply" onclick="applyModalFilter('entities')">Apply Filter</button>
            </div>
        </div>
    </div>

    <div id="warCrimesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">‚ö†Ô∏è War Crimes Filter</h2>
                <button class="modal-close" onclick="closeModal('warCrimesModal')">&times;</button>
            </div>
            <div class="modal-list">
                <div style="padding: 20px;">
                    <p style="margin-bottom: 20px; color: #666;">Filter events by war crime likelihood based on AI analysis.</p>
                    <div class="modal-item">
                        <input type="radio" name="wcFilter" id="wc-all" value="all" checked>
                        <label class="modal-item-label" for="wc-all">
                            <strong>All Events</strong><br>
                            <small style="color: #999;">Show all events regardless of war crime classification</small>
                        </label>
                    </div>
                    <div class="modal-item">
                        <input type="radio" name="wcFilter" id="wc-likely" value="likely">
                        <label class="modal-item-label" for="wc-likely">
                            <strong>Likely War Crimes</strong><br>
                            <small style="color: #999;">Events with score ‚â• 2 (treatment of persons OR civilian targets)</small>
                        </label>
                    </div>
                    <div class="modal-item">
                        <input type="radio" name="wcFilter" id="wc-strong" value="strong">
                        <label class="modal-item-label" for="wc-strong">
                            <strong>Strong Likely War Crimes</strong><br>
                            <small style="color: #999;">Events with score ‚â• 4 (multiple strong indicators)</small>
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-apply" onclick="closeModal('warCrimesModal')">Close</button>
            </div>
        </div>
    </div>

    <div id="systemsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üöÄ Weapon Systems Filter</h2>
                <button class="modal-close" onclick="closeModal('systemsModal')">&times;</button>
            </div>
            <div class="modal-search">
                <input type="text" id="systemsFilterSearch" class="filter-search-box" placeholder="üîç Search systems...">
            </div>
            <div class="filter-controls">
                <button class="select-all" onclick="EntityFilters.selectAllSystems()">Select All</button>
                <button class="clear-all" onclick="EntityFilters.clearAllSystems()">Clear All</button>
            </div>
            <div class="modal-list">
                <div id="systemsTagsContainer" class="filter-tags-container"></div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-apply" onclick="EntityFilters.applySystemsFilter()">Apply Filter</button>
            </div>
        </div>
    </div>

    <div id="unitsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ü™ñ Military Units Filter</h2>
                <button class="modal-close" onclick="closeModal('unitsModal')">&times;</button>
            </div>
            <div class="modal-search">
                <input type="text" id="unitsFilterSearch" class="filter-search-box" placeholder="üîç Search units...">
            </div>
            <div class="filter-controls">
                <button class="select-all" onclick="EntityFilters.selectAllUnits()">Select All</button>
                <button class="clear-all" onclick="EntityFilters.clearAllUnits()">Clear All</button>
            </div>
            <div class="modal-list">
                <div id="unitsTagsContainer" class="filter-tags-container"></div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-apply" onclick="EntityFilters.applyUnitsFilter()">Apply Filter</button>
            </div>
        </div>
    </div>

    <div id="reportsModal" class="modal">
        <div class="modal-content reports-modal-wide">
            <div class="modal-header">
                <h2 class="modal-title">üìä Daily Reports</h2>
                <button class="modal-close" onclick="closeModal('reportsModal')">&times;</button>
            </div>
            <div class="report-selector">
                <label for="reportDateSelect">Select Report Date:</label>
                <div class="report-selector-row">
                    <select id="reportDateSelect" onchange="UIManager.showDailyReport(this.value)">
                        <option value="">-- Select a date --</option>
                    </select>
                    <button class="report-btn report-btn-map" id="showEventsBtn" style="display: none;" onclick="showReportEvents()">
                        <span style="font-size: 16px;">üó∫Ô∏è</span> Show on Map
                    </button>
                    <button class="report-btn report-btn-share" id="shareReportBtn" style="display: none;" onclick="UIManager.shareReport()">
                        <span style="font-size: 16px;">üîó</span> Share Report
                    </button>
                    <button class="report-btn report-btn-video" onclick="UIManager.openVideoModal()">
                        <span style="font-size: 16px;">‚ñ∂Ô∏è</span> OSINT Videoflow
                    </button>
                </div>
            </div>
            <div id="reportContent" class="report-content" style="display: none;"></div>
            <div class="report-disclaimer">
                Reports by Vasama Advanced OSINT analysis LLM
            </div>
        </div>
    </div>

    <div id="favoritesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">‚≠ê Favorites</h2>
                <button class="modal-close" onclick="closeModal('favoritesModal')">&times;</button>
            </div>
            <div class="modal-list" id="favoritesList"></div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-clear" onclick="clearFavorites()">Clear All</button>
                <button class="modal-btn modal-btn-apply" onclick="shareFavorites()">üì§ Share List</button>
                <button class="modal-btn modal-btn-apply" onclick="showFavoritesOnMap()">Show on Map</button>
            </div>
        </div>
    </div>

    <div id="networkModal" class="modal">
        <div class="modal-content" style="max-width: 1200px; max-height: 85vh;">
            <div class="modal-header">
                <h2 class="modal-title">üï∏Ô∏è Entity Network Graph</h2>
                <button class="modal-close" onclick="closeModal('networkModal')">&times;</button>
            </div>
            <div id="networkGraph" style="height: 600px; border: 2px solid #e0e0e0; border-radius: 10px; background: #fafafa;"></div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-clear" onclick="closeModal('networkModal')">Close</button>
            </div>
        </div>
    </div>

    <div id="exportModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 class="modal-title">üì• Export & Share</h2>
                <button class="modal-close" onclick="closeModal('exportModal')">&times;</button>
            </div>
            <div class="export-container">
                <!-- CSV Export Section -->
                <div class="export-section">
                    <h3 class="export-section-title">üìä Export to CSV</h3>
                    <p class="export-section-desc">Download the currently filtered events as a CSV file for external analysis.</p>
                    <button class="export-action-btn" onclick="ExportManager.exportToCSV()">
                        üì• Download CSV
                    </button>
                </div>

                <!-- Shareable Link Section -->
                <div class="export-section">
                    <h3 class="export-section-title">üîó Shareable Link</h3>
                    <p class="export-section-desc">Share your current view with this link (preserves map position, zoom, and all active filters):</p>
                    <input type="text" id="filterShareUrl" readonly class="export-url-input">
                    <div class="export-button-row">
                        <button class="export-action-btn" onclick="navigator.clipboard.writeText(document.getElementById('filterShareUrl').value).then(() => alert('‚úÖ Link copied to clipboard!'))">
                            üìã Copy Link
                        </button>
                        <button class="export-action-btn export-action-btn-secondary" onclick="window.open(document.getElementById('filterShareUrl').value, '_blank')">
                            üîó Open in New Tab
                        </button>
                    </div>
                </div>

                <!-- Filter Presets Section -->
                <div class="export-section">
                    <h3 class="export-section-title">üíæ Filter Presets</h3>
                    <p class="export-section-desc">Save and load your favorite filter combinations for quick access.</p>
                    <button class="export-action-btn" onclick="ExportManager.saveFilterPreset()">
                        üíæ Save Current Filters
                    </button>
                    <div id="presetsListContainer" style="margin-top: 20px;">
                        <!-- Presets list will be populated here -->
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-clear" onclick="closeModal('exportModal')">Close</button>
            </div>
        </div>
    </div>

    <div id="analyticsModal" class="modal">
        <div class="modal-content" style="max-width: 1400px; max-height: 90vh;">
            <div class="modal-header">
                <h2 class="modal-title">üìä Analytics Dashboard</h2>
                <button class="modal-close" onclick="closeModal('analyticsModal')">&times;</button>
            </div>
            <div class="analytics-container">
                <!-- Events Timeline Chart -->
                <div class="analytics-chart-container">
                    <h3 class="analytics-chart-title">üìà Events Over Time</h3>
                    <canvas id="timelineChart"></canvas>
                </div>

                <!-- Two columns for smaller charts -->
                <div class="analytics-row">
                    <div class="analytics-chart-container">
                        <h3 class="analytics-chart-title">üîß Top 10 Systems</h3>
                        <canvas id="systemsChart"></canvas>
                    </div>
                    <div class="analytics-chart-container">
                        <h3 class="analytics-chart-title">‚öîÔ∏è Top 10 Units</h3>
                        <canvas id="unitsChart"></canvas>
                    </div>
                </div>

                <div class="analytics-row">
                    <div class="analytics-chart-container">
                        <h3 class="analytics-chart-title">üìç Top 10 Locations</h3>
                        <canvas id="locationsChart"></canvas>
                    </div>
                    <div class="analytics-chart-container">
                        <h3 class="analytics-chart-title">‚ö†Ô∏è War Crimes Distribution</h3>
                        <canvas id="warCrimesChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-clear" onclick="closeModal('analyticsModal')">Close</button>
            </div>
        </div>
    </div>

    <div id="aboutModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">‚ÑπÔ∏è About</h2>
                <button class="modal-close" onclick="closeModal('aboutModal')">&times;</button>
            </div>
            <div class="modal-list">
                <div style="padding: 40px; text-align: center;">
                    <h3 style="font-size: 24px; color: #667eea; margin-bottom: 20px;">AI makes mistakes. So do you.</h3>
                    <p style="font-size: 18px; color: #333; margin-bottom: 30px; line-height: 1.6;">Together we can make them less?</p>
                    <p style="font-size: 14px; color: #666; margin-bottom: 20px; line-height: 1.8;">
                        This is a static development preview of realtime open data collection, analysis and visualization pipeline.
                    </p>
                    <p style="font-size: 14px; color: #666; margin-bottom: 30px; line-height: 1.8;">
                        Data is updated irregularly and most surely contains some errors (ex. with datetime, geolocation) but we are getting better everyday.
                    </p>
                    <div style="margin-top: 40px; padding-top: 30px; border-top: 2px solid #e0e0e0;">
                        <p style="font-size: 16px; font-weight: 600; color: #667eea; margin-bottom: 10px;">¬© Vasama Systems 2025</p>
                        <p style="font-size: 14px; color: #667eea;">
                            <a href="mailto:info@vasama.systems" style="color: #667eea; text-decoration: none; font-weight: 600;">info@vasama.systems</a>
                        </p>
                    </div>

                    <!-- Changelog Section -->
                    <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #e0e0e0;">
                        <h4 style="font-size: 18px; font-weight: 600; color: #667eea; margin-bottom: 15px;">üìã Changelog</h4>
                        <div class="changelog-container">
                            <div class="changelog-entry">
                                <div class="changelog-date">15-11-2025</div>
                                <div class="changelog-message">Added OSINT timeline analysis podcast player to main view</div>
                            </div>
                            <div class="changelog-entry">
                                <div class="changelog-date">15-11-2025</div>
                                <div class="changelog-message">Added OSINT videoflow player to Daily Reports</div>
                            </div>
                            <div class="changelog-entry">
                                <div class="changelog-date">15-11-2025</div>
                                <div class="changelog-message">Streamlined UI</div>
                            </div>
                            <div class="changelog-entry">
                                <div class="changelog-date">15-11-2025</div>
                                <div class="changelog-message">Updated current map dataset from 1.-14.11.2025</div>
                            </div>
                            <div class="changelog-entry">
                                <div class="changelog-date">15-11-2025</div>
                                <div class="changelog-message">Added dark theme</div>
                            </div>
                            <div class="changelog-entry">
                                <div class="changelog-date">14-11-2025</div>
                                <div class="changelog-message">Geolocation model updated, events after 14.11.2025 are located more precise.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-apply" onclick="closeModal('aboutModal')">Close</button>
            </div>
        </div>
    </div>

    <div id="videoModal" class="modal">
        <div class="modal-content" style="max-width: 90vw; max-height: 90vh;">
            <div class="modal-header">
                <h2 class="modal-title">‚ñ∂Ô∏è OSINT Videoflow</h2>
                <button class="modal-close" onclick="UIManager.closeVideoModal()">&times;</button>
            </div>
            <div style="padding: 0; display: flex; justify-content: center; align-items: center; background: #000;">
                <video id="videoPlayer" controls style="max-width: 100%; max-height: 75vh;">
                    <source src="timeline_video.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-clear" onclick="UIManager.closeVideoModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Feed Panel (Fixed Position) -->
    <div class="feed-panel" id="feedPanel">
        <div class="feed-header">
            <h2>üì± Feed</h2>
            <button class="feed-close-btn" id="feedCloseBtn">√ó</button>
        </div>
        <div class="feed-content" id="feedContent">
            <div class="feed-empty">
                <div style="font-size: 48px; margin-bottom: 20px;">üì±</div>
                <div>Telegram posts will appear here</div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-container">
        <div class="map-container">
            <div id="map"></div>
        </div>
        <div class="side-panel empty" id="sidePanel">
            <div>
                <div style="font-size: 48px; margin-bottom: 20px;">üìç</div>
                <div>Click on any marker to view event details</div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vis-network@9.1.2/dist/vis-network.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- Application Modules -->
    <script src="warCrimeDetector.js"></script>
    <script src="dataProcessor.js"></script>
    <script src="storageManager.js"></script>
    <script src="entities.js"></script>
    <script src="entityFilters.js"></script>
    <script src="hyperlinkProcessor.js"></script>
    <script src="analyticsManager.js"></script>
    <script src="exportManager.js"></script>
    <script src="searchEnhancer.js"></script>
    <script src="mapManager.js"></script>
    <script src="uiManager.js"></script>
    <script src="main.js"></script>

    <!-- Mobile Detection and Desktop Mode Notice -->
    <script>
        (function() {
            // Detect mobile devices more accurately
            const isMobileUserAgent = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isSmallScreen = window.innerWidth <= 1024; // Typical mobile/tablet max width
            const hasTouchOnly = navigator.maxTouchPoints > 0 && !window.matchMedia("(pointer: fine)").matches;

            // Only show on actual mobile devices (not desktop browsers or touchscreen desktops)
            const isMobile = isMobileUserAgent && (isSmallScreen || hasTouchOnly);

            // Check if user has already seen the notice
            const hasSeenNotice = sessionStorage.getItem('mobileNoticeShown');

            if (isMobile && !hasSeenNotice) {
                // Wait for page to load before showing notice
                window.addEventListener('load', function() {
                    // Create overlay
                    const overlay = document.createElement('div');
                    overlay.style.cssText = `
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: rgba(0, 0, 0, 0.7);
                        z-index: 10000;
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        animation: fadeIn 0.3s ease-in;
                    `;

                    // Create notice box
                    const noticeBox = document.createElement('div');
                    noticeBox.style.cssText = `
                        background: white;
                        padding: 30px;
                        border-radius: 12px;
                        max-width: 400px;
                        margin: 20px;
                        text-align: center;
                        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
                    `;

                    noticeBox.innerHTML = `
                        <div style="font-size: 48px; margin-bottom: 20px;">üíª</div>
                        <h2 style="color: #667eea; margin-bottom: 15px; font-size: 22px;">Desktop Experience</h2>
                        <p style="color: #666; margin-bottom: 20px; line-height: 1.6; font-size: 15px;">
                            This application is optimized for desktop experience.<br>
                            You can zoom and pan the entire page for better viewing.
                        </p>
                        <button id="closeMobileNotice" style="
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white;
                            border: none;
                            padding: 12px 30px;
                            border-radius: 8px;
                            font-size: 16px;
                            font-weight: 600;
                            cursor: pointer;
                            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
                        ">Got it!</button>
                    `;

                    overlay.appendChild(noticeBox);
                    document.body.appendChild(overlay);

                    // Close button handler
                    document.getElementById('closeMobileNotice').addEventListener('click', function() {
                        overlay.style.animation = 'fadeOut 0.3s ease-out';
                        setTimeout(function() {
                            document.body.removeChild(overlay);
                        }, 300);
                        sessionStorage.setItem('mobileNoticeShown', 'true');
                    });

                    // Click overlay to close
                    overlay.addEventListener('click', function(e) {
                        if (e.target === overlay) {
                            document.getElementById('closeMobileNotice').click();
                        }
                    });
                });
            }
        })();
    </script>

    <style>
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
    </style>
</body>
</html>